#!/bin/bash

set -e

source ./scripts/version-bump.sh
source ./scripts/git-check.sh
source ./scripts/publishing.sh

# patch, minor or major
SEMVER_TYPE=$1
DIST_TAG=${2:-next}

exit_unless_valid_semver "$SEMVER_TYPE"
exit_unless_valid_branch "develop"
exit_unless_clean_git_folder

yarn test
yarn docs
git add -A && git commit -m 'Update docs'

version_bump "$SEMVER_TYPE"
git push --tags && git push
publish_to_dist_tag "$DIST_TAG"